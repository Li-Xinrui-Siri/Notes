# Lec1 操作系统导论

## 1.1 操作系统的定义

### 操作系统的定义

#### 操作系统是什么

计算机用户与计算机硬件之间运行的一个程序

#### 操作系统的工作内容

**资源管理服务**：硬件资源和软件资源

**为用户提供服务**：交互、提供应用程序的运行环境

#### 操作系统是硬件还是软件

软件。

操作系统是一直运行在计算机上的程序，通常狭义上被称为内核程序，其他程序称为系统程序和应用程序

操作系统是**资源管理平台**、**运行程序的平台**，也是**为用户提供服务的平台**

## 1.2 计算机系统的结构

### 层次结构

<img src="C:\Users\AA\AppData\Roaming\Typora\typora-user-images\image-20240910093033142.png" alt="image-20240910093033142" style="zoom:45%;margin-left:0px;" />

#### 硬件

最基本的计算资源：CPU、内存、I/O设备等

#### 操作系统

协调控制多个应用或多个用户对硬件的使用

#### 应用程序

定义了解决方法的程序：如文体编辑器, 网页浏览器, 数据库, 游戏等

#### 用户

人、设备、其他计算机系统

## 1.3 计算机系统的组织

单个或多个中央处理器通过总线与内存和设备控制器相连。

### 启动

确认每个设备是否**工作正常**。确认无误后，开启**引导程序**。

#### 引导程序

引导程序一般位于 ROM 或 EEROM 中，称为计算机硬件中的固件。

##### 工作内容

1. 初始化设备

2. 把操作系统载入到内存中

3. 运行第一个进程 init(), 等待事件发生

### 中断

一个事件的触发是通过**硬件或软件中断**来实现的

在实现操作系统功能时，中断是一个非常重要的实现机制

#### 软中断

即通过软件触发中断。系统调用(System Call) 会触发软件中断。 如异常，除零（ divide by zero），**不可以屏蔽**

#### 硬中断

即硬件通过向CPU发送信号来触发中断，一般对用户不可见，但可触发程序的运行。如网卡接收数据包，**可以屏蔽**

#### 中断处理

系统一旦发生中断，CPU会运行**中断服务程序**，且每个中断都有自己对应的中断服务程序ISR

系统通过**中断向量表**来管理中断请求与中断服务程序之间的对应关系

#### 中断的工作流程

当发生中断时：
- 保存当前进程的程序计数器（Program Counter）
- 跳到相应的中断服务程序中，运行相应的中断服务程序

一旦中断服务程序运行结束：

- 返回到被中断的程序（by PC），并继续往下运行
- 或者返回到操作系统指定的程序中

现代的操作系统一般被视为以**中断驱动**或**事件驱动**的系统

<img src="C:\Users\AA\AppData\Roaming\Typora\typora-user-images\image-20240910144352488.png" alt="image-20240910144352488" style="zoom: 30%; margin-left: 0px;" /><img src="C:\Users\AA\AppData\Roaming\Typora\typora-user-images\image-20240910145509633.png" alt="image-20240910145509633" style="zoom:30%;margin-right:0px" />



### I/O结构

#### 结构

1. I/O设备与CPU可同时运行
2. 每个设备控制器负责相应类型的设备，如磁盘控制器负责磁盘
3. 每个设备控制器拥有自己的本地缓冲器和寄存器

#### 功能

1. **CPU**负责内存与本地缓冲器之间的数据传递
2. **设备控制器**负责在其所控制的外部设备与本地缓冲存储之间进行数据传递
3.  I/O 操作结束后，设备控制器**通过中断**通知 CPU 表示 I/O结束

#### I/O操作方法 